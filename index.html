<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Globber’s Ink Log</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;800&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div class="page">
    <div class="topbar">
      <div class="brandRow">
        <div class="brandLeft">
          <div class="logoPlain" title="Tap to upload logo" id="logoWrap">
            <img id="logoImg" class="logoImgPlain" alt="Logo">
            <input id="logoInput" type="file" accept="image/png,image/*" style="display:none;">
          </div>

          <div class="brandText">
            <div class="brandTitle">Globber’s Ink Log</div>

            <!-- Top actions -->
            <div class="brandActions">
              <button class="topBtn" type="button" onclick="openSettings()">
                Split: <b id="splitPillPct">100%</b>
              </button>

              <button class="topBtn" type="button" onclick="openBills()">Bills</button>
              <button class="topBtn" type="button" onclick="openExport()">Export</button>
              <button class="topBtn secondarybtn" type="button" onclick="openRewards()">Rewards</button>
            </div>
          </div>
        </div>

        <!-- Quick actions moved to top bar -->
        <div class="quickActionsTop">
          <button class="topBtn secondarybtn" type="button" onclick="openDepositQuick()">Deposit</button>
          <button class="topBtn secondarybtn" type="button" onclick="openBammerQuick()">Bammer</button>
          <button class="topBtn" type="button" onclick="openForm()">+ Entry</button>
        </div>
      </div>

      <!-- Stats centered -->
      <div class="stats statsCentered">
        <div class="stat"><div class="statNum" id="todayTotal">$0</div><div class="statLbl">Today</div></div>
        <div class="stat"><div class="statNum" id="weekTotal">$0</div><div class="statLbl">Week</div></div>
        <div class="stat"><div class="statNum" id="monthTotal">$0</div><div class="statLbl">Month</div></div>
        <div class="stat"><div class="statNum" id="quarterTotal">$0</div><div class="statLbl">Quarter</div></div>
        <div class="stat"><div class="statNum" id="yearTotal">$0</div><div class="statLbl">Year</div></div>
      </div>
    </div>

    <div class="filters">
      <div class="filtersHeader" id="filtersHeader">
        <div style="display:flex;align-items:baseline;gap:10px;flex-wrap:wrap;">
          <div class="filtersTitle">Filters</div>
          <div class="filtersSummary" id="filtersSummary">All entries</div>
        </div>
        <div class="filtersChev" id="filtersChev">▾</div>
      </div>

      <div class="filtersContent" id="filtersContent">
        <div class="row">
          <div class="field">
            <label>Search</label>
            <input id="q" type="text" />
          </div>

          <div class="field">
            <label>Status</label>
            <select id="statusFilter">
              <option value="all">All</option>
              <option value="booked">Booked</option>
              <option value="paid">Paid</option>
              <option value="partial">Partial</option>
              <option value="unpaid">Unpaid</option>
              <option value="no_show">No Show</option>
            </select>
          </div>

          <div class="field">
            <label>Location</label>
            <select id="locationFilter">
              <option value="all">All</option>
            </select>
          </div>
        </div>

        <div class="row">
          <div class="field">
            <label>From</label>
            <input id="fromDate" type="date">
          </div>

          <div class="field">
            <label>To</label>
            <input id="toDate" type="date">
          </div>

          <div class="field">
            <label>Sort</label>
            <select id="sortFilter">
              <option value="newest">Newest</option>
              <option value="oldest">Oldest</option>
            </select>
          </div>
        </div>

        <div class="actionsRow">
          <button type="button" class="secondarybtn" onclick="clearFilters()">Clear</button>
          <button type="button" onclick="applyFilters()">Apply</button>
        </div>
      </div>
    </div>

    <div class="entries" id="entries"></div>
  </div>

  <!-- ADD/EDIT ENTRY MODAL -->
  <div class="modal" id="formModal">
    <div class="modalBox" id="formBox">
      <div class="modal-title" id="formTitle">Add Entry</div>

      <div class="sectionDivider"></div>

      <div class="row">
        <div class="field">
          <label>Date</label>
          <input type="date" id="date">
        </div>

        <div class="field">
          <label>Client Name</label>
          <input type="text" id="client">
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>Client Contact</label>
          <input type="text" id="contact">
        </div>
        <div class="field">
          <label>Client Social</label>
          <input type="text" id="social">
        </div>
      </div>

      <div class="field">
        <label>Description</label>
        <textarea id="description"></textarea>
      </div>

      <div class="row">
        <div class="field">
          <label>Location</label>
          <select id="location">
            <option value=""></option>
            <option>Arm</option><option>Leg</option><option>Back</option><option>Chest</option>
            <option>Hand</option><option>Foot</option><option>Neck</option>
          </select>
        </div>

        <div class="field">
          <label>Status</label>
          <select id="status">
            <option value="booked">Booked</option>
            <option value="unpaid">Unpaid</option>
            <option value="partial">Partial</option>
            <option value="paid">Paid</option>
            <option value="no_show">No Show</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>Total Price</label>
          <input type="number" id="total" min="0" step="0.01">
        </div>
        <div class="field">
          <label>Deposit</label>
          <input type="number" id="deposit" min="0" step="0.01">
        </div>
      </div>

      <div class="sectionDivider"></div>

      <div class="field">
        <label>Sessions</label>
        <div id="sessions"></div>
      </div>
      <button type="button" class="secondarybtn" onclick="addSession()">+ Add Session</button>

      <div class="sectionDivider"></div>

      <div class="field">
        <label>Notes</label>
        <textarea id="notes"></textarea>
      </div>

      <div class="field">
        <label>Image</label>
        <input type="file" id="image" accept="image/*">
      </div>

      <div class="actionsRow">
        <button type="button" onclick="saveEntry()">Save</button>
        <button type="button" class="secondarybtn" onclick="closeForm()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- QUICK ADD: BAMMER -->
  <div class="modal" id="bammerModal">
    <div class="modalBox" id="bammerBox">
      <div class="modal-title">Quick Add — Bammer</div>
      <div class="sectionDivider"></div>

      <div class="row">
        <div class="field">
          <label>Date</label>
          <input type="date" id="bDate">
        </div>
        <div class="field">
          <label>Client Name</label>
          <input type="text" id="bClient">
        </div>
      </div>

      <div class="field">
        <label>Description</label>
        <textarea id="bDesc"></textarea>
      </div>

      <div class="row">
        <div class="field">
          <label>Location</label>
          <select id="bLocation">
            <option value=""></option>
            <option>Arm</option><option>Leg</option><option>Back</option><option>Chest</option>
            <option>Hand</option><option>Foot</option><option>Neck</option>
          </select>
        </div>
        <div class="field">
          <label>Total Price</label>
          <input type="number" id="bTotal" min="0" step="0.01">
        </div>
      </div>

      <div class="field">
        <label>Status</label>
        <select id="bStatus">
          <option value="paid">Paid</option>
          <option value="partial">Partial</option>
          <option value="unpaid">Unpaid</option>
          <option value="booked">Booked</option>
          <option value="no_show">No Show</option>
        </select>
      </div>

      <div class="actionsRow">
        <button type="button" onclick="saveBammer()">Save</button>
        <button type="button" class="secondarybtn" onclick="closeBammerQuick()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- QUICK ADD: DEPOSIT ONLY -->
  <div class="modal" id="depositModal">
    <div class="modalBox" id="depositBox">
      <div class="modal-title">Quick Add — Deposit Only</div>
      <div class="sectionDivider"></div>

      <div class="row">
        <div class="field">
          <label>Date</label>
          <input type="date" id="dDate">
        </div>
        <div class="field">
          <label>Client Name</label>
          <input type="text" id="dClient">
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>Client Contact</label>
          <input type="text" id="dContact">
        </div>
        <div class="field">
          <label>Client Social</label>
          <input type="text" id="dSocial">
        </div>
      </div>

      <div class="field">
        <label>Description</label>
        <textarea id="dDesc"></textarea>
      </div>

      <div class="row">
        <div class="field">
          <label>Deposit Amount</label>
          <input type="number" id="dDeposit" min="0" step="0.01">
        </div>
        <div class="field">
          <label>Total Price (optional)</label>
          <input type="number" id="dTotal" min="0" step="0.01">
        </div>
      </div>

      <div class="field">
        <label>Location</label>
        <select id="dLocation">
          <option value=""></option>
          <option>Arm</option><option>Leg</option><option>Back</option><option>Chest</option>
          <option>Hand</option><option>Foot</option><option>Neck</option>
        </select>
      </div>

      <div class="actionsRow">
        <button type="button" onclick="saveDepositOnly()">Save</button>
        <button type="button" class="secondarybtn" onclick="closeDepositQuick()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- VIEW / CLIENT -->
  <div class="modal" id="viewModal"><div class="modalBox" id="viewBox"></div></div>
  <div class="modal" id="clientModal"><div class="modalBox" id="clientBox"></div></div>

  <!-- SETTINGS -->
  <div class="modal" id="settingsModal">
    <div class="modalBox" id="settingsBox">
      <div class="modal-title">Settings</div>

      <div class="sectionDivider"></div>

      <div class="summary-box" style="margin-top:0;">
        <div style="font-weight:900;color:var(--gold);">Payout Split</div>
        <div class="row">
          <div class="field">
            <label>Default Split %</label>
            <input id="defaultSplitPct" type="number" min="0" max="100" step="1">
          </div>
        </div>
      </div>

      <div class="sectionDivider"></div>

      <div class="summary-box">
        <div style="font-weight:900;color:var(--gold);">Monthly Override</div>
        <div class="row">
          <div class="field">
            <label>Month</label>
            <input id="overrideMonth" type="month">
          </div>
          <div class="field">
            <label>Split %</label>
            <input id="overridePct" type="number" min="0" max="100" step="1">
          </div>
        </div>
        <div class="actionsRow">
          <button type="button" onclick="saveMonthOverride()">Save Override</button>
          <button type="button" class="secondarybtn" onclick="removeMonthOverride()">Remove Override</button>
        </div>
        <div id="overrideList" class="hint" style="margin-top:10px;"></div>
      </div>

      <div class="sectionDivider"></div>

      <div class="summary-box">
        <div style="font-weight:900;color:var(--gold);">Backup / Restore</div>
        <div class="actionsRow">
          <button type="button" onclick="downloadBackup()">Download Backup (JSON)</button>
        </div>
        <div class="sectionDivider"></div>
        <div class="field">
          <label>Restore File</label>
          <input id="restoreFile" type="file" accept="application/json">
        </div>
        <div class="actionsRow">
          <button type="button" class="dangerbtn" onclick="restoreBackup()">Restore Backup</button>
        </div>
      </div>

      <div class="actionsRow">
        <button type="button" onclick="saveSplitSettings()">Save</button>
        <button type="button" class="secondarybtn" onclick="closeSettings()">Close</button>
      </div>
    </div>
  </div>

  <!-- REWARDS -->
  <div class="modal" id="rewardsModal">
    <div class="modalBox" id="rewardsBox">
      <div class="modal-title">Client Rewards Setup</div>
      <div class="sectionDivider"></div>

      <details open>
        <summary>Badge Levels</summary>
        <div id="levelsList" style="margin-top:10px;"></div>
        <div class="actionsRow">
          <button type="button" onclick="addBadgeLevel()">+ Add Badge Level</button>
        </div>
      </details>

      <div class="sectionDivider"></div>

      <details open>
        <summary>Discount Tiers</summary>
        <div id="discountsList" style="margin-top:10px;"></div>
        <div class="actionsRow">
          <button type="button" onclick="addDiscountTier()">+ Add Discount Tier</button>
        </div>
      </details>

      <div class="actionsRow">
        <button type="button" onclick="saveRewards()">Save</button>
        <button type="button" class="secondarybtn" onclick="closeRewards()">Close</button>
      </div>
    </div>
  </div>

  <!-- EXPORT -->
  <div class="modal" id="exportModal">
    <div class="modalBox" id="exportBox">
      <div class="modal-title">Export</div>
      <div class="sectionDivider"></div>

      <div class="field">
        <label>Payday</label>
        <select id="paydaySelect">
          <option value="0">Sunday</option><option value="1">Monday</option><option value="2">Tuesday</option>
          <option value="3">Wednesday</option><option value="4">Thursday</option><option value="5">Friday</option>
          <option value="6">Saturday</option>
        </select>
      </div>

      <div class="sectionDivider"></div>

      <div class="field">
        <label>Pay Period</label>
        <div class="row">
          <div class="field">
            <label>Start</label>
            <input type="date" id="ppStart" disabled>
          </div>
          <div class="field">
            <label>End</label>
            <input type="date" id="ppEnd" disabled>
          </div>
        </div>
        <div class="actionsRow">
          <button type="button" class="secondarybtn" onclick="prevPayPeriod()">◀ Prev</button>
          <button type="button" class="secondarybtn" onclick="nextPayPeriod()">Next ▶</button>
          <button type="button" onclick="exportPayPeriodCSV()">Download CSV</button>
        </div>
      </div>

      <div class="sectionDivider"></div>

      <div class="field">
        <label>Date Range</label>
        <div class="row">
          <div class="field">
            <label>Start</label>
            <input type="date" id="exportStart">
          </div>
          <div class="field">
            <label>End</label>
            <input type="date" id="exportEnd">
          </div>
        </div>
        <div class="actionsRow">
          <button type="button" onclick="exportCSV()">Download CSV</button>
          <button type="button" class="secondarybtn" onclick="closeExport()">Close</button>
        </div>
      </div>

      <div class="sectionDivider"></div>

      <div class="summary-box">
        <div style="font-weight:900;color:var(--gold);">Summary</div>
        <div class="actionsRow">
          <button type="button" onclick="buildSummary('range')">Range Summary</button>
          <button type="button" class="secondarybtn" onclick="buildSummary('payperiod')">Pay Period Summary</button>
        </div>
        <div id="summaryOut" style="margin-top:10px;"></div>
      </div>
    </div>
  </div>

  <!-- BILLS -->
  <div class="modal" id="billsModal">
    <div class="modalBox" id="billsBox">
      <div class="modal-title">Bills & Rent</div>

      <div class="sectionDivider"></div>

      <div class="summary-box" style="margin-top:0;">
        <div style="font-weight:900;color:var(--gold);">Rent</div>
        <div class="hint">Due on the 1st. Every month. No exceptions.</div>

        <div class="row">
          <div class="field">
            <label>Rent Amount</label>
            <input id="rentAmount" type="number" min="0" step="0.01">
          </div>

          <div class="field">
            <label>Saved So Far</label>
            <input id="rentSavedSoFar" type="number" min="0" step="0.01">
          </div>
        </div>

        <!-- Safe-by is back -->
        <div class="row">
          <div class="field">
            <label>Safe By (day of month)</label>
            <input id="rentSafeByDay" type="number" min="1" max="28" step="1">
          </div>
          <div class="hint" style="align-self:flex-end;">
            Example: 15 means “fund next rent by the 15th.”
          </div>
        </div>
      </div>

      <div class="sectionDivider"></div>

      <div class="summary-box">
        <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between;">
          <div style="font-weight:900;color:var(--gold);">Bills</div>
          <div class="actionsRow" style="margin-top:0;">
            <button type="button" onclick="InkBills.addBill()">+ Add Bill</button>
          </div>
        </div>
        <div id="billsList" style="margin-top:10px;"></div>
      </div>

      <div class="sectionDivider"></div>

      <div class="summary-box">
        <div style="font-weight:900;color:var(--gold);">Today’s target</div>
        <div id="billsTodayOut" style="margin-top:8px;"></div>
        <div id="billsQuote" style="margin-top:12px; font-weight:900; color:var(--gold); opacity:.92;"></div>
      </div>

      <div class="actionsRow">
        <button type="button" onclick="InkBills.saveBills()">Save</button>
        <button type="button" class="secondarybtn" onclick="InkBills.closeBills()">Close</button>
      </div>
    </div>
  </div>

  <div class="toasts" id="toasts"></div>

  <script src="app.js"></script>
  <script src="bills.js"></script>
</body>
</html>